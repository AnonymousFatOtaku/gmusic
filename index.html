<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport"
        content="width=device-width,initial-scale=1.0,user-scalable=no,minimum-scale=1.0,maximum-scale=1.0"/>
  <title></title>
  <link rel="stylesheet" href="css/tai.css"/>
</head>
<body>
<div id="wrap">
  <div class="head">
    <div class="head-top">
      <!-- logo -->
      <h1 class="logo">
        <a href="http://www.yinyuetai.com/">
          <img src="img/logo.png"/>
        </a>
      </h1>
      <!-- 面包屑导航 -->
      <a href="javascript:;" class="menuBtn"></a>
      <!-- 按钮排 -->
      <div class="btns">
        <a href="javascript:;" class="search">搜索</a>
        <a href="javascript:;">登录</a>
        <a href="javascript:;">注册</a>
      </div>
    </div>
    <div class="head-bottom">
      <form method="post">
        <input type="text" placeholder="请输入搜索内容"/>
        <input type="submit" value="搜索"/>
      </form>
    </div>
    <ul class="mask">
      <li>
        <a href="javascript:;">首页</a>
      </li>
      <li>
        <a href="javascript:;">频道</a>
      </li>
      <li>
        <a href="javascript:;">V榜</a>
      </li>
      <li>
        <a href="javascript:;">商城</a>
      </li>
      <li>
        <a href="javascript:;">众筹</a>
      </li>
      <li>
        <a href="javascript:;">悦单</a>
      </li>
      <li>
        <a href="javascript:;">APP下载</a>
      </li>
    </ul>
  </div>
  <div class="content">
    <div class="test-nav-drag-wrapper">
      <ul class="list">
        <li>
          <a href="javascript:;" class="active">首页</a>
        </li>
        <li>
          <a href="javascript:;">频道</a>
        </li>
        <li>
          <a href="javascript:;">V榜</a>
        </li>
        <li>
          <a href="javascript:;">商城</a>
        </li>
        <li>
          <a href="javascript:;">众筹</a>
        </li>
        <li>
          <a href="javascript:;">悦单</a>
        </li>
        <li>
          <a href="javascript:;">APP下载</a>
        </li>
      </ul>
    </div>
    <div class="carousel-wrap" needAuto>
      <div class="points-wrap"></div>
    </div>
  </div>
</div>
</body>
<script src="js/tools.js"></script>
<script src="js/test.js"></script>
<script type="text/javascript">
  window.onload = function () {
    document.addEventListener("touchstart", function (ev) {
      ev = ev || event;
      ev.preventDefault();
    })

    ;(function () {
      var styleNode = document.createElement("style");
      var w = document.documentElement.clientWidth / 16;
      styleNode.innerHTML = "html{font-size:" + w + "px!important}";
      document.head.appendChild(styleNode);
    })()


    // 导航点击变色
    changeColor();

    function changeColor() {
      var list = document.querySelector("#wrap .content .test-nav-drag-wrapper .list");
      var aNodes = document.querySelectorAll("#wrap .content .test-nav-drag-wrapper .list>li a");

      list.addEventListener("touchstart", function () {
        this.isMove = false;
      })

      list.addEventListener("touchmove", function () {
        this.isMove = true;
      })

      list.addEventListener("touchend", function (ev) {
        if (this.isMove) {
          return;
        }
        ev = ev || event;
        var touchC = ev.changedTouches[0];
        for (var i = 0; i < aNodes.length; i++) {
          tools.removeClass(aNodes[i], "active");
        }
        tools.addClass(touchC.target, "active");
      })
    }


    // 无缝滑屏
    swiper()

    function swiper() {
      var arr = ["img/1.jpg", "img/2.jpg", "img/3.jpg", "img/4.jpg", "img/5.jpg"]
      test.carousel(arr);
    }

    // 可拖拽的导航
    drag();

    function drag() {
      test.dragNav();
    }

    changeFocus()

    function changeFocus() {
      var inputText = document.querySelector("#wrap .head .head-bottom form input[type='text']");
      inputText.addEventListener("touchstart", function (ev) {
        ev = ev || event;
        this.focus();
        ev.stopPropagation();
        ev.preventDefault();
      })
      document.addEventListener("touchstart", function () {
        inputText.blur();
      })
    }

    CMCFMenuBtn();

    function CMCFMenuBtn() {
      var menuBtn = document.querySelector("#wrap .head .head-top .menuBtn");
      var mask = document.querySelector("#wrap .head .mask");
      // isXX:false  频道按钮
      // isXX:ture	  XX按钮
      var isXX = false;
      
      menuBtn.addEventListener("touchstart", function (ev) {
        ev = ev || event;
        var touchC = ev.changedTouches[0];
        if (!isXX) {
          tools.addClass(menuBtn, "active");
          mask.style.display = "block";
        } else {
          tools.removeClass(menuBtn, "active");
          mask.style.display = "none";
        }
        isXX = !isXX;
        ev.stopPropagation();
        ev.preventDefault();
      })

      document.addEventListener("touchstart", function () {
        if (isXX) {
          tools.removeClass(menuBtn, "active");
          mask.style.display = "none";
          isXX = !isXX;
        }
      })

      mask.addEventListener("touchstart", function (ev) {
        ev = ev || event;
        ev.stopPropagation();
        ev.preventDefault();
      })
    }
  }
</script>
</html>
